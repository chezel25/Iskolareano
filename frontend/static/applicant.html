<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Applicant Dashboard</title>
 <style>body { margin:0; font-family:"Segoe UI",Arial,sans-serif; background:#eef4ff; }
.container { max-width:900px; margin:30px auto; padding:20px; }
.header { display:flex; justify-content:space-between; align-items:center; }
.header button { padding:8px 10px; border:1px solid #ddd; background:white; border-radius:8px; cursor:pointer; }
.card { background:white; border-radius:16px; padding:20px; margin-top:20px; }
.status-header { display:flex; justify-content:space-between; align-items:center; }
.badge { background:#fde68a; color:#92400e; padding:6px 12px; border-radius:999px; font-size:12px; font-weight:600; }
.progress-wrapper { margin-top:15px; }
.progress-label { display:flex; justify-content:space-between; font-size:14px; margin-bottom:6px; }
.progress-bar { height:8px; background:#e5e7eb; border-radius:999px; overflow:hidden; }
#progressFill { height:100%; width:0%; background:#111827; transition:width 0.4s ease; }
.tracker { list-style:none; padding:0; }
.tracker li { display:flex; gap:12px; margin-bottom:18px; opacity:0.4; }
.tracker li.active { opacity:1; }
.dot { width:14px; height:14px; border-radius:50%; border:2px solid #9ca3af; margin-top:4px; }
.active .dot { background:#111827; border-color:#111827; }
.muted { color:#6b7280; font-size:14px; }

</style>
</head>
<body>
a
<div class="container">

  <!-- HEADER -->
  <div class="header">
    <div>
      <h1>Welcome, <span id="applicantName">Applicant</span>!</h1>
      <p>Applicant Dashboard</p>
  </div>
    <button onclick="location.href='applicant-requirements.html'">requirements</button>
    <button onclick="location.href='login.html'">Logout</button>
  </div>

  <!-- STATUS CARD -->
  <div class="card">
    <div class="status-header">
      <h3>Application Status</h3>
      <span id="statusBadge" class="badge">Pending Review</span>
    </div>

    <div class="progress-wrapper">
      <div class="progress-label">
        <span>Overall Progress</span>
        <span id="progressPercent">0%</span>
      </div>
      <div class="progress-bar">
        <div id="progressFill"></div>
      </div>
    </div>
  </div>

  <!-- TRACKER -->
  <div class="card">
    <h3>Application Tracker</h3>
    <p class="muted">Track your progress through each stage</p>

    <ul class="tracker">
      <li id="step-requirements">
        <span class="dot"></span>
        <div>
          <strong>Requirements Review</strong>
          <small>Waiting for admin review</small>
        </div>
      </li>

      <li id="step-exam">
        <span class="dot"></span>
        <div>
          <strong>Examination</strong>
          <small>Complete requirements review first</small>
        </div>
      </li>

      <li id="step-mswd">
        <span class="dot"></span>
        <div>
          <strong>MSWD Evaluation</strong>
          <small>Pass the exam first</small>
        </div>
      </li>

      <li id="step-scholar">
        <span class="dot"></span>
        <div>
          <strong>Scholar Status</strong>
          <small>Complete all previous steps</small>
        </div>
      </li>
    </ul>
  </div>

</div>

<script>console.log("âœ… admin.js loaded");

// REQUIRED so HTML onclick works
window.loadApplicants = async function () {
  console.log("ðŸ“„ Loading applicants...");

  const res = await fetch('http://localhost:5000/api/admin/applicants');
  const data = await res.json();

  // Update stats
  document.getElementById('total').innerText = data.stats.total;
  document.getElementById('pending').innerText = data.stats.pending;
  document.getElementById('approved').innerText = data.stats.approved;
  document.getElementById('rejected').innerText = data.stats.rejected;

  let html = `
    <h2>Applicants</h2>
    <table>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
  `;

  data.applicants.forEach(a => {
    html += `
      <tr>
        <td>${a.first_name} ${a.last_name}</td>
        <td>${a.email}</td>
        <td>${a.status}</td>
        <td>
          <button class="approve" onclick="approveApplicant('${a.id}')">Approve</button>
          <button class="reject" onclick="rejectApplicant('${a.id}')">Reject</button>
        </td>
      </tr>
    `;
  });

  html += `</table>`;
  document.getElementById('content').innerHTML = html;
};

window.approveApplicant = async function (id) {
  await fetch(`http://localhost:5000/api/admin/applicant/${id}/approve`, {
    method: 'POST'
  });
  loadApplicants();
};

window.rejectApplicant = async function (id) {
  await fetch(`http://localhost:5000/api/admin/applicant/${id}/reject`, {
    method: 'POST'
  });
  loadApplicants();
};

window.loadScholars = async function () {
  const res = await fetch('http://localhost:5000/api/admin/scholars');
  const data = await res.json();

  let html = `<h2>Scholars</h2><table>
    <tr><th>ID</th><th>Name</th><th>Email</th></tr>`;

  data.forEach(s => {
    html += `
      <tr>
        <td>${s.scholar_id}</td>
        <td>${s.full_name}</td>
        <td>${s.email}</td>
      </tr>`;
  });

  html += `</table>`;
  document.getElementById('content').innerHTML = html;
};
</script>

</body>
</html>
