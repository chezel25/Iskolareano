<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Change Password</title>
<style>
  :root {
    --orange: #FF7700;
    --navy: #002054;
    --light-gray: #F2F2F2;
    --white: #ffffff;
  }
  body {
    margin: 0;
    background-color: var(--light-gray);
    font-family: 'Segoe UI', Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
  }
  .container {
    width: 380px;
    background: var(--white);
    padding: 2.5rem 2.2rem;
    border-radius: 22px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    text-align: center;
  }
  .title { font-size: 1.9rem; font-weight: 900; color: var(--navy); }
  .title span { color: var(--orange); }
  .subtitle { margin-top: 4px; font-size: 1.25rem; font-weight: 700; color: var(--navy); }
  .input-box { width: 100%; padding: 1rem; margin-top: 1.2rem; border-radius: 16px; border: 1.5px solid #bcbcbc; font-size: 1rem; background: #f7f7f7; text-align: left; box-sizing: border-box; }
  .input-box::placeholder { color: #888; }
  .input-box:focus { outline: none; border-color: var(--orange); box-shadow: 0 0 0 3px rgba(255,119,0,0.25); }
  button { width: 100%; margin-top: 1.8rem; padding: 1rem; background: var(--orange); color: var(--white); font-size: 1.15rem; border: none; border-radius: 22px; cursor: pointer; font-weight: 700; transition: 0.3s; }
  button:hover { background: #e06200; }
  .back { display: block; margin-top: 1rem; font-size: 0.95rem; color: var(--navy); text-decoration: none; }
  .back:hover { text-decoration: underline; }
</style>
</head>
<body>

<div class="container">
  <div class="title">ISKOLA<span>REALEÑO</span></div>
  <div class="subtitle">Change Password</div>



<input type="password" id="password" placeholder="Enter new password">
  <button onclick="resetPassword()">Reset Password</button>
</div>

<script>
async function resetPassword() {
  const newPassword = document.getElementById('password').value.trim();
  if (!newPassword) {
    alert("Please enter a new password");
    return;
  }

  // --- Read access_token from URL hash ---
  const hashParams = new URLSearchParams(window.location.hash.substring(1));
  const access_token = hashParams.get('access_token');

  if (!access_token) {
    alert("Access token missing in URL");
    return;
  }

  const res = await fetch('/api/reset-password', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ access_token, newPassword })
  });

  const data = await res.json();

  if (res.ok) {
    alert("✅ Password reset successful!");
    window.location.href = "/login.html";
  } else {
    alert("❌ " + data.error);
  }
}

</script>

</body>
</html>